<!-- Card fija en el ángulo superior derecho para info de documents -->
<div style="position: absolute; top: 24px; right: 24px; z-index: 1000; width: 350px;">
  <div class="card border-primary">
    <div class="card-header bg-primary text-white p-2">
      <h6 class="mb-0">Info tabla documents</h6>
    </div>
    <div class="card-body p-2">
      <div *ngIf="documentsInfo">
        <div *ngIf="documentsInfo.error" class="text-danger">{{ documentsInfo.error }}</div>
        <div *ngIf="!documentsInfo.error">
          <div class="mb-2">
            <strong>Cantidad de registros:&nbsp;</strong>
            <span>{{ documentsInfo.count }}</span>
          </div>
          <!-- <div *ngIf="documentsInfo.earliest_created_at">
            <strong>Primer registro:&nbsp;</strong>
            <span>{{ documentsInfo.earliest_created_at | date:'dd/MM/yyyy' }}</span>
          </div>
          <div *ngIf="documentsInfo.latest_created_at">
            <strong>Último registro:&nbsp;</strong>
            <span>{{ documentsInfo.latest_created_at | date:'dd/MM/yyyy' }}</span>
          </div> -->
          <!-- Borrar un embedding por su id -->
          <div class="mb-2">
            <span>Eliminar embedding por ID:&nbsp;</span>
            <input #deleteIdInput type="number" class="form-control form-control-sm d-inline-block w-auto align-middle" placeholder="ID" />
            <button class="btn btn-danger btn-sm mx-2 align-middle" (click)="deleteEmbeddingById(+deleteIdInput.value)">Eliminar</button>
            <!-- El signo + que precede a deleteIdInput.value es un truco de JavaScript/TypeScript para convertir el valor
             del input (que siempre es un texto/string) a un tipo numérico, ya que la función deleteEmbeddingById espera
             recibir un número. -->
          </div>
        </div>

      </div>
      <div *ngIf="!documentsInfo">
        <span class="text-muted">Cargando información...</span>
      </div>
    </div>
  </div>
</div>

<!-- Card para los primeros n documentos -->
<div
    style="position: absolute; top: 24px; left: 49.3%; transform: translateX(-50%); z-index: 10000; width: 620px; max-height: 350px; overflow-y: auto;">
  <div class="card border-info">
    <div class="card-header bg-primary text-white p-2 d-flex justify-content-between align-items-center">
      <h6 class="mb-0">Primeros registros (máximo 100)</h6>
      <button class="btn btn-sm btn-light" (click)="closeEarliestTable()" title="Cerrar">&times;</button>
    </div>
    <div class="card-body p-2">
      <div class="mb-2 d-flex align-items-center">
        <label for="earliestDocumentsCount" class="me-2 mb-0">Cantidad:</label>
        <input id="earliestDocumentsCount" type="number" min="1" [(ngModel)]="earliestDocumentsCount"
          class="form-control form-control-sm w-auto me-2" />
        <button class="btn btn-primary btn-sm" (click)="loadEarliestDocuments(earliestDocumentsCount)">OK</button>
      </div>
      <div *ngIf="showEarliestTable && earliestDocuments.length > 0">
        <table class="table table-sm table-bordered mb-0">
          <thead>
            <tr>
              <th>#</th>
              <th>ID</th>
              <th>Texto</th>
              <th>Fecha creación</th>
              <th>Modelo</th>
              <th>Timestamp</th>
              <th>Source</th>
            </tr>
          </thead>
          <tbody>
            <tr *ngFor="let doc of earliestDocuments; let i = index">
              <td>{{ i + 1 }}</td>
              <td>{{ doc.id }}</td>
              <td>{{ doc.content }}</td>
              <td>{{ doc.created_at | date:'dd/MM/yyyy HH:mm' }}</td>
              <td>{{ doc.metadata?.model }}</td>
              <td>{{ doc.metadata?.timestamp | date:'dd/MM/yyyy HH:mm' }}</td>
              <td>{{ doc.source }}</td>
            </tr>
          </tbody>
        </table>
      </div>
      <div *ngIf="!showEarliestTable || earliestDocuments.length === 0">
        <span class="text-muted">Cargando registros...</span>
      </div>
    </div>
  </div>
</div>

<!-- Card para los ultimos n documentos -->
<div
    style="position: absolute; top: 182px; left: 49.3%; transform: translateX(-50%); z-index: 8000; width: 620px; max-height: 300px; overflow-y: auto;">
  <div class="card border-info">
    <div class="card-header bg-primary text-white p-2 d-flex justify-content-between align-items-center">
      <h6 class="mb-0">Últimos registros (máximo 100)</h6>
      <button class="btn btn-sm btn-light" (click)="closeLatestTable()" title="Cerrar">&times;</button>
    </div>
    <div class="card-body p-2">
      <div class="mb-2 d-flex align-items-center">
        <label for="latestDocumentsCount" class="me-2 mb-0">Cantidad:</label>
        <input id="latestDocumentsCount" type="number" min="1" [(ngModel)]="latestDocumentsCount"
          class="form-control form-control-sm w-auto me-2" />
        <button class="btn btn-primary btn-sm" (click)="loadLatestDocuments(latestDocumentsCount)">OK</button>
      </div>
      <div *ngIf="latestDocuments.length > 0">
        <table class="table table-sm table-bordered mb-0">
          <thead>
            <tr>
              <th>#</th>
              <th>ID</th>
              <th>Texto</th>
              <th>Fecha creación</th>
              <th>Modelo</th>
              <th>Timestamp</th>
              <th>Source</th>
            </tr>
          </thead>
          <tbody>
            <tr *ngFor="let doc of latestDocuments; let i = index">
              <td>{{ i + 1 }}</td>
              <td>{{ doc.id }}</td>
              <td>{{ doc.content }}</td>
              <td>{{ doc.created_at | date:'dd/MM/yyyy HH:mm' }}</td>
              <td>{{ doc.metadata?.model }}</td>
              <td>{{ doc.metadata?.timestamp | date:'dd/MM/yyyy HH:mm' }}</td>
              <td>{{ doc.source }}</td>
            </tr>
          </tbody>
        </table>
      </div>
      <div *ngIf="latestDocuments.length === 0">
        <span class="text-muted">Cargando registros...</span>
      </div>
    </div>
  </div>
</div>

<!-- Card para un rango de documentos -->
<div
    style="position: absolute; top: 340px; left: 49.3%; transform: translateX(-50%); z-index: 6000; width: 620px; max-height: 200px; overflow-y: auto;">
  <div class="card border-info">
    <div class="card-header bg-primary text-white p-2 d-flex justify-content-between align-items-center">
      <h6 class="mb-0">Rango de documentos (máximo 100)</h6>
      <button class="btn btn-sm btn-light" (click)="closeDocumentsRangeTable()" title="Cerrar">&times;</button>
    </div>
    <div class="card-body p-2">
      <div class="mb-2 d-flex align-items-center">
        <label for="documentsRangeStartId" class="me-2 mb-0">Desde ID:</label>
        <input id="documentsRangeStartId" type="number" min="1" [(ngModel)]="documentsRangeStartId"
          class="form-control form-control-sm w-auto me-2" />
        <label for="documentsRangeEndId" class="me-2 mb-0">Hasta ID:</label>
        <input id="documentsRangeEndId" type="number" min="1" [(ngModel)]="documentsRangeEndId"
          class="form-control form-control-sm w-auto me-2" />
        <button class="btn btn-primary btn-sm" (click)="loadDocumentsRange(documentsRangeStartId, documentsRangeEndId)">OK</button>
      </div>
      <div *ngIf="documentsRange.length > 0">
        <table class="table table-sm table-bordered mb-0">
          <thead>
            <tr>
              <th>#</th>
              <th>ID</th>
              <th>Texto</th>
              <th>Fecha creación</th>
              <th>Modelo</th>
              <th>Timestamp</th>
              <th>Source</th>
            </tr>
          </thead>
          <tbody>
            <tr *ngFor="let doc of documentsRange; let i = index">
              <td>{{ i + 1 }}</td>
              <td>{{ doc.id }}</td>
              <td>{{ doc.content }}</td>
              <td>{{ doc.created_at | date:'dd/MM/yyyy HH:mm' }}</td>
              <td>{{ doc.metadata?.model }}</td>
              <td>{{ doc.metadata?.timestamp | date:'dd/MM/yyyy HH:mm' }}</td>
              <td>{{ doc.source }}</td>
            </tr>
          </tbody>
        </table>
      </div>
      <div *ngIf="documentsRange.length === 0">
        <span class="text-muted">Cargando registros...</span>
      </div>
    </div>
  </div>
</div>

<!-- Sección de tarjetas para info del modelo, salud del modelo, embedding single y multi-embedding -->
<section style="padding-left: 0; margin-left: 0;">
  <div style="margin-left:10px; padding-left:0; margin-top: 24px;">
    <div class="card w-25">
      <div class="card-header text-white" (click)="toggleCardInfo()">
        <button (click)="modelInfo()" class="btn btn-primary btn-sm">Info del modelo</button>
      </div>
      <div class="card-body" *ngIf="showContentInfo">
        <ul>
          @if (infoModel?.model_name) {
          <li>Nombre del modelo: {{ infoModel?.model_name }}</li>
          }
          @if (infoModel?.description) {
          <li>Descripción: {{ infoModel?.description }}</li>
          }
          @if (infoModel?.dimensions) {
          <li>Dimensiones del modelo: {{ infoModel?.dimensions }}</li>
          }
          @if (infoModel?.language) {
          <li>Idioma: {{ infoModel?.language }}</li>
          }
          @if (infoModel?.use_case) {
          <li>Caso de uso: {{ infoModel?.use_case }}</li>
          }
          @if (infoModel?.max_sequence_length) {
          <li>Longitud máxima de secuencia (longitud máxima de tokens que el modelo puede procesar en una sola
            entrada.):
            {{ infoModel?.max_sequence_length }}</li>
          }
        </ul>
      </div>
    </div>

    <div class="card w-25">
      <div class="card-header text-white" (click)="toggleCardHealth()">
        <button (click)="modelHealth()" class="btn btn-primary btn-sm">Salud del modelo</button>
      </div>
      <div class="card-body" *ngIf="showContentHealth">
        <ul>
          @if (infoModelHealth?.status) {
          <li>Estado: {{ infoModelHealth?.status }}</li>
          }
          @if (infoModelHealth?.model) {
          <li>Descripción: {{ infoModelHealth?.model }}</li>
          }
          @if (infoModelHealth?.api_url) {
          <li>URL de la API: {{ infoModelHealth?.api_url }}</li>
          }
          @if (infoModelHealth?.test_embedding_dimensions) {
          <li>Dimensiones de la prueba de incrustación: {{ infoModelHealth?.test_embedding_dimensions }}</li>
          }
          @if (infoModelHealth?.token_configured) {
          <li>Tokenización: {{ infoModelHealth?.token_configured }}</li>
          }
        </ul>
      </div>
    </div>

    <div class="card w-25">
      <div class="card-header text-black" (click)="toggleCardEmbeddingSingle()">
        <h5 class="card-title mb-0 btn-text">Generar un embedding a partir de un solo párrafo (Single-Embedding)</h5>
      </div>
      <div class="card-body" *ngIf="showContentEmbeddingSingle">
        
        <div class="input-group mb-3">
          <input type="text" class="form-control" placeholder="Ingrese texto para procesar" [(ngModel)]="embeddingText">
        </div>
        <button class="btn btn-primary btn-sm" type="button" (click)="getEmbedding()">Obtener Embedding</button>

        <div *ngIf="embeddingResult">
          <h6>Resultado:</h6>
          <pre class="bg-light p-2"
            style="max-height: 230px; overflow: auto;"><code>{{ embeddingResult | json }}</code></pre>
        </div>
      </div>
    </div>

    <div class="card w-25">
      <div class="card-header text-black" (click)="toggleCardEmbeddingMulti()">
        <h5 class="card-title mb-0 btn-text">Generar mas de un embedding a partir de varios párrafos (Multi-Embedding)</h5>
      </div>
      <div class="card-body" *ngIf="showContentEmbeddingMulti">
        
        <div class="input-group mb-3">
          <textarea class="form-control" rows="5"
            placeholder='Ingrese textos entre comillas dobles separados por comas: "Texto Uno","Texto Dos"'
            #rawMultiInput></textarea>
        </div>
        <button class="btn btn-primary btn-sm" type="button" (click)="handleMultiEmbedding(rawMultiInput.value)">Obtener
          Multi-Embedding</button>

        <div *ngIf="multiEmbeddingError" class="alert alert-danger mt-2">
          {{ multiEmbeddingError }}
        </div>
        <div *ngIf="multiEmbeddingResult">
          <h6>Resultado:</h6>
          <pre class="bg-light p-2"
            style="max-height: 230px; overflow: auto;"><code>{{ multiEmbeddingResult | json }}</code></pre>
        </div>
      </div>
    </div>
  </div>
</section>